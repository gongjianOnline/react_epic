{"version":3,"sources":["components/uploader.js","components/Tips.js","pages/Home.js"],"names":["Result","styled","div","H1","h1","Image","img","Component","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setwidth","height","setheight","serverFile","attributes","url","widthStr","heightStr","Dragger","Upload","props","showUploadList","beforeUpload","file","console","log","setFile","setFilename","name","currentUser","message","warning","test","type","size","error","upload","then","catch","tip","spinning","isUploading","className","InboxOutlined","target","href","filename","src","alt","ref","onChange","current","value","placeholder","getFullStr","Tips","children","Home"],"mappings":"mNAOMA,EAASC,IAAOC,IAAV,+FAKNC,EAAKF,IAAOG,GAAV,sEAIFC,EAAQJ,IAAOK,IAAV,+CA4GIC,EAxGIC,aAAS,WAAK,IAAD,EACCC,cAAxBC,EADuB,EACvBA,WAAWC,EADY,EACZA,UACZC,EAAOC,mBACPC,EAAOD,mBACPE,EAAQC,aAAc,iBAAK,CAC/BC,MAAM,KACNC,SAF+B,SAEtBD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAkBF,EAAME,OAAQ,IAEzCE,OAAO,KACPC,UAT+B,SASrBD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAmBJ,EAAMI,QAAS,IAE3C,iBACE,OAAOT,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAIlGC,GADIb,mBACQc,IAAZD,SAOFE,EAAQ,CACZC,gBAAe,EACfC,aAAc,SAACC,GAIb,OAHAC,QAAQC,IAAIF,GACZrB,EAAWwB,QAAQH,GACnBrB,EAAWyB,YAAYJ,EAAKK,MACC,OAA1BzB,EAAU0B,aACXC,IAAQC,QAAQ,+CACT,GAEL,wCAAwCC,KAAKT,EAAKU,MAInDV,EAAKW,KAAO,SACbJ,IAAQK,MAAM,+BACP,IAETjC,EAAWkC,SAASC,MAAK,SAACxB,GACxBW,QAAQC,IAAI,4BACZD,QAAQC,IAAIZ,MACXyB,OAAM,WACPd,QAAQC,IAAI,gCAEP,IAbLK,IAAQK,MAAM,0EACP,KAeb,OACE,qCACE,cAAC,IAAD,CAAMI,IAAI,wBAASC,SAAUtC,EAAWuC,YAAxC,SACE,8BACE,eAACvB,EAAD,2BAAaE,GAAb,cACE,mBAAGsB,UAAU,uBAAb,SACE,cAACC,EAAA,EAAD,MAEF,mBAAGD,UAAU,kBAAb,oEACA,mBAAGA,UAAU,kBAAb,sHAQJxC,EAAWW,WAAa,eAACrB,EAAD,WACtB,cAACG,EAAD,uCACA,+BACE,0DACA,6BACE,mBAAGiD,OAAO,SAASC,KAAM3C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAzE,SACGb,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,QAGrD,oDACA,6BAAKb,EAAW4C,WAChB,0DACA,6BACE,cAACjD,EAAD,CAAOkD,IAAK7C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAKiC,IAAI,+BAEvE,0DACA,+BACE,uBAAOC,IAAK7C,EAAM8C,SAnEN,WACtB3C,EAAMG,SAASN,EAAK+C,QAAQC,QAkE2BnB,KAAK,OAAOoB,YAAY,2CACrE,uBAAOJ,IAAK3C,EAAM4C,SAjEL,WACvB3C,EAAMK,UAAUN,EAAK6C,QAAQC,QAgE2BnB,KAAK,OAAOoB,YAAY,8CAExE,6BACE,mBAAGT,OAAO,SAASC,KAAMtC,EAAM+C,WAA/B,SAA4C/C,EAAM+C,qBAG5C,WClHdC,EAAO9D,IAAOC,IAAV,mIAoBKK,EAZIC,aAAS,YAAe,IAAbwD,EAAY,EAAZA,SACrBrD,EAAaF,cAAbE,UACP,OACE,mCAEIA,EAAU0B,YAAa,KAAO,cAAC0B,EAAD,UAC3BC,SCdLC,EAAOzD,aAAS,WACAC,cAAbE,UACP,OACE,qCACE,cAAC,EAAD,yDACA,cAAC,EAAD,UAISsD","file":"static/js/9.3242caa8.chunk.js","sourcesContent":["import React,{useRef} from \"react\"\r\nimport {useStores} from \"../stores\";\r\nimport {observer,useLocalStore} from \"mobx-react\"\r\nimport { Upload, message,Spin, Alert } from 'antd';\r\nimport { InboxOutlined } from '@ant-design/icons';\r\nimport styled from \"styled-components\"\r\n\r\nconst Result = styled.div`\r\n  margin-top: 30px;\r\n  border: 1px dashed #ccc;\r\n  padding: 20px;\r\n`\r\nconst H1 = styled.h1`\r\n  margin: 20px 0;\r\n  text-align: center;\r\n`\r\nconst Image = styled.img`\r\n  max-width:300px\r\n`\r\n\r\nconst  Component = observer(()=>{\r\n  const {ImageStore,UserStore} = useStores();\r\n  const ref1 = useRef();\r\n  const ref2 = useRef();\r\n  const store = useLocalStore(()=>({\r\n    width:null,\r\n    setwidth(width){\r\n      store.width = width\r\n    },\r\n    get widthStr(){\r\n      return store.width?`/w/${store.width}`:''\r\n    },\r\n    height:null,\r\n    setheight(height){\r\n      store.height = height\r\n    },\r\n    get heightStr(){\r\n      return store.height?`/h/${store.height}`:''\r\n    },\r\n    get getFullStr(){\r\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n    }\r\n  }))\r\n  const ref = useRef()\r\n  const { Dragger } = Upload;\r\n  const bindWidthChange = ()=>{\r\n    store.setwidth(ref1.current.value)\r\n  };\r\n  const bindHeightChange = ()=>{\r\n    store.setheight(ref2.current.value)\r\n  };\r\n  const props = {\r\n    showUploadList:false,\r\n    beforeUpload: (file)=>{\r\n      console.log(file)\r\n      ImageStore.setFile(file);\r\n      ImageStore.setFilename(file.name);\r\n      if(UserStore.currentUser === null){\r\n        message.warning('请先登录再上传');\r\n        return false\r\n      }\r\n      if(!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)){\r\n        message.error('只能上传png/svg/jpg/gif格式的图片');\r\n        return false\r\n      }\r\n      if(file.size > 1024*1024){\r\n        message.error('图片最大1M');\r\n        return false\r\n      }\r\n      ImageStore.upload().then((serverFile)=>{\r\n        console.log('上传成功')\r\n        console.log(serverFile)\r\n      }).catch(()=>{\r\n        console.log(\"上传失败\")\r\n      })\r\n      return false;\r\n    }\r\n  };\r\n  return (\r\n    <>\r\n      <Spin tip=\"上传中...\" spinning={ImageStore.isUploading}>\r\n        <div>\r\n          <Dragger {...props}>\r\n            <p className=\"ant-upload-drag-icon\">\r\n              <InboxOutlined />\r\n            </p>\r\n            <p className=\"ant-upload-text\">点击或拖拽上传图片</p>\r\n            <p className=\"ant-upload-hint\">\r\n              仅支持 .png/.svg/.jpg/.gif 格式的图片,图片最大1M\r\n            </p>\r\n          </Dragger>\r\n        </div>\r\n      </Spin>\r\n\r\n      {\r\n        ImageStore.serverFile ? <Result>\r\n          <H1>上传结果</H1>\r\n          <dl>\r\n            <dt>完整路径</dt>\r\n            <dd>\r\n              <a target=\"_blank\" href={ImageStore.serverFile.attributes.url.attributes.url}>\r\n                {ImageStore.serverFile.attributes.url.attributes.url}\r\n              </a>\r\n            </dd>\r\n            <dt>文件名</dt>\r\n            <dd>{ImageStore.filename}</dd>\r\n            <dt>图片预览</dt>\r\n            <dd>\r\n              <Image src={ImageStore.serverFile.attributes.url.attributes.url} alt=\"图片预览\"/>\r\n            </dd>\r\n            <dt>更多尺寸</dt>\r\n            <dd>\r\n              <input ref={ref1} onChange={bindWidthChange} type=\"text\" placeholder=\"最大宽度(可选)\"/>\r\n              <input ref={ref2} onChange={bindHeightChange} type=\"text\" placeholder=\"最大高度(可选)\"/>\r\n            </dd>\r\n            <dd>\r\n              <a target='_blank' href={store.getFullStr}>{store.getFullStr}</a>\r\n            </dd>\r\n          </dl>\r\n        </Result> : null\r\n      }\r\n    </>\r\n  )\r\n})\r\nexport default Component","import React from \"react\"\r\nimport {useStores} from \"../stores/index\"\r\nimport {observer} from \"mobx-react\"\r\nimport styled from \"styled-components\"\r\n\r\nconst Tips = styled.div`\r\n  background: lightsalmon;\r\n  padding: 10px;\r\n  margin: 30px 0;\r\n  color:#fff;\r\n  border-radius: 4pz;\r\n`\r\n\r\nconst  Component = observer(({children})=>{\r\n  const {UserStore} = useStores();\r\n  return (\r\n    <>\r\n      {\r\n        UserStore.currentUser? null : <Tips>\r\n          {children}\r\n        </Tips>\r\n      }\r\n    </>\r\n  )\r\n})\r\nexport default Component","import React from \"react\"\r\nimport {observer} from 'mobx-react'\r\nimport {useStores} from \"../stores\"\r\nimport Uploader from \"../components/uploader\"\r\nimport Tips from \"../components/Tips\"\r\nconst Home = observer(()=>{\r\n  const {UserStore} = useStores()\r\n  return(\r\n    <>\r\n      <Tips>请先登录在上传</Tips>\r\n      <Uploader></Uploader>\r\n    </>\r\n  )\r\n})\r\nexport default Home"],"sourceRoot":""}